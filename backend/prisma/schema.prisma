generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id           Int           @id @default(autoincrement())
  name         String
  email        String        @unique
  password     String
  photoUrl     String?
  nivel        Int           @default(1)
  pontos       Int           @default(0)
  Medalha      Medalha[]
  treinos      Treino[]
  gamificacoes Gamificacao[]
}

model Treino {
  id              Int               @id @default(autoincrement())
  titulo          String
  data            DateTime
  userId          Int
  descanso        Int?
  alimentacao     Int?
  humor           Int?
  esforco         Int?
  observacoes     String?
  notes           Note[]
  user            User              @relation(fields: [userId], references: [id])
  TreinoExercicio TreinoExercicio[]
}

model Exercise {
  id              Int               @id @default(autoincrement())
  name            String            @unique
  photoUrl        String?
  musculo         String?
  TreinoExercicio TreinoExercicio[]
}

model Note {
  id       Int     @id @default(autoincrement())
  content  String
  treinoId Int?
  treino   Treino? @relation(fields: [treinoId], references: [id])
}

model Medalha {
  id            Int         @id @default(autoincrement())
  nome          String
  descricao     String
  userId        Int
  gamificacaoId Int
  dataConquista DateTime    @default(now())
  User          User        @relation(fields: [userId], references: [id])
  gamificacao   Gamificacao @relation(fields: [gamificacaoId], references: [id], name: "GamificacaoMedalha")
}

model Serie {
  id                Int             @id @default(autoincrement())
  treinoExercicioId Int
  tipoSerie         String
  carga             Int
  reps              Int
  TreinoExercicio   TreinoExercicio @relation(fields: [treinoExercicioId], references: [id])
}

model TreinoExercicio {
  id         Int      @id @default(autoincrement())
  treinoId   Int
  exerciseId Int
  carga      Int
  Serie      Serie[]
  Exercise   Exercise @relation(fields: [exerciseId], references: [id])
  Treino     Treino   @relation(fields: [treinoId], references: [id])
}

model Gamificacao {
  id        Int      @id @default(autoincrement())
  userId    Int
  pontos    Int      @default(0)
  xpGanho   Int
  nivel     Int      @default(1) // âœ… adicionado
  descricao String?
  data      DateTime @default(now())

  user     User      @relation(fields: [userId], references: [id])
  medalhas Medalha[] @relation("GamificacaoMedalha")
}
